# æ— äººé©¾é©¶æ•°æ®ç®¡ç†å¹³å°æ¨¡å—åˆ’åˆ†ä¸å®ç°æ–¹æ¡ˆ

## 1. æ¨¡å—æ€»ä½“åˆ’åˆ†

### 1.1 æ ¸å¿ƒæ¨¡å—ç»“æ„

```
platform/
â”œâ”€â”€ src/                          # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ auth.py                   # ç”¨æˆ·è®¤è¯æ¨¡å—
â”‚   â”œâ”€â”€ main.py                   # ä¸»åº”ç”¨ç¨‹åºå’ŒUIæ¨¡å—
â”‚   â”œâ”€â”€ check_db.py              # æ•°æ®åº“æ£€æŸ¥å·¥å…·
â”‚   â”œâ”€â”€ demo_login.py            # ç™»å½•æ¼”ç¤ºè„šæœ¬
â”‚   â””â”€â”€ project_status.py        # é¡¹ç›®çŠ¶æ€æ£€æŸ¥
â”œâ”€â”€ test/                        # æµ‹è¯•æ¨¡å—ç›®å½•
â”‚   â”œâ”€â”€ test_auth.py             # è®¤è¯åŠŸèƒ½æµ‹è¯•
â”‚   â”œâ”€â”€ test_basic.py            # åŸºç¡€åŠŸèƒ½æµ‹è¯•
â”‚   â”œâ”€â”€ test_pointcloud.py       # ç‚¹äº‘åŠŸèƒ½æµ‹è¯•
â”‚   â””â”€â”€ test_pointcloud_unit.py  # ç‚¹äº‘å•å…ƒæµ‹è¯•
â”œâ”€â”€ config/                      # é…ç½®ç›®å½•
â”‚   â”œâ”€â”€ requirements.txt         # Pythonä¾èµ–é…ç½®
â”‚   â””â”€â”€ pyproject.toml          # é¡¹ç›®é…ç½®
â”œâ”€â”€ scripts/                     # è„šæœ¬ç›®å½•
â”‚   â”œâ”€â”€ start_app.bat           # Windowså¯åŠ¨è„šæœ¬
â”‚   â””â”€â”€ start_app.sh            # Unixå¯åŠ¨è„šæœ¬
â”œâ”€â”€ data/                       # æ•°æ®ç›®å½•
â”‚   â””â”€â”€ temp_pointclouds/       # ä¸´æ—¶ç‚¹äº‘æ•°æ®
â””â”€â”€ docs/                       # æ–‡æ¡£ç›®å½•
    â””â”€â”€ æ¶æ„è®¾è®¡æ–‡æ¡£.md          # æ¶æ„è®¾è®¡æ–‡æ¡£
```

### 1.2 æ¨¡å—ä¾èµ–å…³ç³»

```mermaid
graph TB
    A[main.py] --> B[auth.py]
    A --> C[æ•°æ®åº“å±‚]
    A --> D[æ–‡ä»¶ç³»ç»Ÿ]
    B --> C
    E[test_auth.py] --> B
    F[test_pointcloud.py] --> A
    G[test_basic.py] --> A
    H[project_status.py] --> A
    H --> B
    I[demo_login.py] --> B
    J[check_db.py] --> C
```

## 2. è¯¦ç»†æ¨¡å—åˆ†æ

### 2.1 ç”¨æˆ·è®¤è¯æ¨¡å— (auth.py)

#### 2.1.1 æ¨¡å—èŒè´£
è¯¥æ¨¡å—è´Ÿè´£æ•´ä¸ªå¹³å°çš„ç”¨æˆ·èº«ä»½è®¤è¯å’Œæˆæƒç®¡ç†ï¼Œæ˜¯ç³»ç»Ÿå®‰å…¨çš„æ ¸å¿ƒæ¨¡å—ã€‚

#### 2.1.2 æ ¸å¿ƒåŠŸèƒ½
```python
# ä¸»è¦åŠŸèƒ½ç±»åˆ«
1. ç”¨æˆ·ç®¡ç†
   - ç”¨æˆ·æ³¨å†Œ (register_user)
   - ç”¨æˆ·éªŒè¯ (authenticate_user)
   - ç”¨æˆ·ä¿¡æ¯ç®¡ç†

2. å¯†ç å®‰å…¨
   - å¯†ç å“ˆå¸Œå¤„ç† (hash_password)
   - å¯†ç å¼ºåº¦éªŒè¯ (validate_password)
   - ç›å€¼ç”Ÿæˆå’Œç®¡ç†

3. ä¼šè¯ç®¡ç†
   - ä¼šè¯åˆ›å»º (create_user_session)
   - ä¼šè¯éªŒè¯ (verify_session)
   - ä¼šè¯å¤±æ•ˆå¤„ç† (invalidate_session)

4. å®‰å…¨ç­–ç•¥
   - ç™»å½•å°è¯•é™åˆ¶
   - è´¦æˆ·é”å®šæœºåˆ¶ (lock_user_account)
   - è§£é”å¤„ç† (clear_user_lock)

5. è¾“å…¥éªŒè¯
   - ç”¨æˆ·åæ ¼å¼éªŒè¯ (validate_username)
   - é‚®ç®±æ ¼å¼éªŒè¯ (validate_email)
   - è¾“å…¥å®‰å…¨æ£€æŸ¥
```

#### 2.1.3 æ•°æ®ç»“æ„è®¾è®¡
```sql
-- ç”¨æˆ·åŸºç¡€ä¿¡æ¯è¡¨
users {
    id: INTEGER PRIMARY KEY          -- ç”¨æˆ·ID
    username: TEXT UNIQUE           -- ç”¨æˆ·å
    email: TEXT UNIQUE             -- é‚®ç®±åœ°å€
    password_hash: TEXT            -- å¯†ç å“ˆå¸Œå€¼
    salt: TEXT                     -- å¯†ç ç›å€¼
    created_at: TEXT               -- åˆ›å»ºæ—¶é—´
    last_login: TEXT               -- æœ€åç™»å½•æ—¶é—´
    is_active: INTEGER             -- è´¦æˆ·çŠ¶æ€
    failed_login_attempts: INTEGER -- å¤±è´¥ç™»å½•æ¬¡æ•°
    locked_until: TEXT             -- é”å®šæˆªæ­¢æ—¶é—´
}

-- ç”¨æˆ·ä¼šè¯è¡¨
user_sessions {
    id: INTEGER PRIMARY KEY        -- ä¼šè¯ID
    user_id: INTEGER              -- å…³è”ç”¨æˆ·ID
    session_token: TEXT UNIQUE    -- ä¼šè¯ä»¤ç‰Œ
    created_at: TEXT              -- åˆ›å»ºæ—¶é—´
    expires_at: TEXT              -- è¿‡æœŸæ—¶é—´
    is_active: INTEGER            -- ä¼šè¯çŠ¶æ€
}
```

#### 2.1.4 å®‰å…¨ç‰¹æ€§
```python
# å®‰å…¨é…ç½®å¸¸é‡
SESSION_TIMEOUT_HOURS = 24    # ä¼šè¯è¶…æ—¶æ—¶é—´
MIN_PASSWORD_LENGTH = 6      # æœ€å°å¯†ç é•¿åº¦
MAX_LOGIN_ATTEMPTS = 5       # æœ€å¤§ç™»å½•å°è¯•æ¬¡æ•°

# å®‰å…¨å®ç°
- PBKDF2-HMAC-SHA256 å¯†ç åŠ å¯† (100,000æ¬¡è¿­ä»£)
- 32å­—èŠ‚éšæœºç›å€¼
- è‡ªåŠ¨è´¦æˆ·é”å®š (5æ¬¡å¤±è´¥é”å®š1å°æ—¶)
- ä¼šè¯ä»¤ç‰Œè‡ªåŠ¨è¿‡æœŸ
- è¾“å…¥æ ¼å¼ä¸¥æ ¼éªŒè¯
```

#### 2.1.5 Streamlité›†æˆ
```python
# UIé›†æˆç»„ä»¶
def show_login_page():     # ç™»å½•ç•Œé¢
def show_register_page():  # æ³¨å†Œç•Œé¢
def show_user_info():      # ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
def check_authentication(): # è®¤è¯çŠ¶æ€æ£€æŸ¥

# æ¡†æ¶è§£è€¦è®¾è®¡
- ä½¿ç”¨MockStreamlitç±»è¿›è¡Œæµ‹è¯•ç¯å¢ƒé€‚é…
- æ ¸å¿ƒé€»è¾‘ä¸UIæ¡†æ¶åˆ†ç¦»
- æ”¯æŒæ— GUIç¯å¢ƒä¸‹çš„åŠŸèƒ½æµ‹è¯•
```

### 2.2 ä¸»åº”ç”¨æ¨¡å— (main.py)

#### 2.2.1 æ¨¡å—èŒè´£
ä¸»åº”ç”¨æ¨¡å—æ˜¯æ•´ä¸ªå¹³å°çš„æ ¸å¿ƒåè°ƒå™¨ï¼Œè´Ÿè´£UIå‘ˆç°ã€ä¸šåŠ¡é€»è¾‘åè°ƒå’Œç”¨æˆ·äº¤äº’å¤„ç†ã€‚

#### 2.2.2 å­æ¨¡å—åˆ’åˆ†

##### A. æ•°æ®ç®¡ç†å­æ¨¡å—
```python
# æ•°æ®é›†ç®¡ç†
class DatasetManager:
    def init_database():           # æ•°æ®åº“åˆå§‹åŒ–
    def show_upload_page():        # æ•°æ®ä¸Šä¼ ç•Œé¢
    def show_browse_page():        # æ•°æ®æµè§ˆç•Œé¢
    def delete_dataset():          # æ•°æ®é›†åˆ é™¤

# æ ¸å¿ƒåŠŸèƒ½
- æ”¯æŒå¤šæ ¼å¼æ–‡ä»¶ä¸Šä¼  (.bag, .pcd, .png, .jpg, .yaml, .csv, .json)
- æ•°æ®é›†å…ƒæ•°æ®ç®¡ç†
- æ–‡ä»¶å­˜å‚¨å’Œç»„ç»‡
- æœç´¢å’Œè¿‡æ»¤åŠŸèƒ½
```

##### B. ç‚¹äº‘å¤„ç†å­æ¨¡å—
```python
# ç‚¹äº‘æ•°æ®å¤„ç†
class PointCloudProcessor:
    def load_point_cloud():       # ç‚¹äº‘åŠ è½½
    def visualize_single_pointcloud():  # å•ç‚¹äº‘å¯è§†åŒ–
    def visualize_multiple_pointclouds(): # å¤šç‚¹äº‘å¯¹æ¯”

# æ”¯æŒæ ¼å¼
- .pcd (Open3Dæ ‡å‡†æ ¼å¼)
- .las/.laz (æ¿€å…‰é›·è¾¾æ ‡å‡†æ ¼å¼)  
- .txt/.xyz (æ–‡æœ¬æ ¼å¼ï¼Œæ”¯æŒXYZå’ŒXYZRGB)

# å¯è§†åŒ–ç‰¹æ€§
- æ™ºèƒ½é‡‡æ · (æ€§èƒ½ä¼˜åŒ–)
- å¤šç§é¢œè‰²æ˜ å°„æ¨¡å¼
- äº¤äº’å¼3Dè§†è§’æ§åˆ¶
- ç»Ÿè®¡ä¿¡æ¯å±•ç¤º
- å¤šæ–‡ä»¶å¯¹æ¯”åˆ†æ
```

##### C. å¯è§†åŒ–å¼•æ“å­æ¨¡å—
```python
# å¯è§†åŒ–æ ¸å¿ƒç»„ä»¶
class VisualizationEngine:
    def create_3d_scatter_plot():  # 3Dæ•£ç‚¹å›¾åˆ›å»º
    def apply_color_mapping():     # é¢œè‰²æ˜ å°„
    def setup_camera_views():      # è§†è§’æ§åˆ¶
    def generate_statistics():     # ç»Ÿè®¡ä¿¡æ¯ç”Ÿæˆ

# å¯è§†åŒ–ç±»å‹
1. å•ç‚¹äº‘è¯¦ç»†å¯è§†åŒ–
   - é«˜åº¦é¢œè‰²æ˜ å°„
   - åŸå§‹é¢œè‰²æ˜¾ç¤º
   - ç»Ÿä¸€é¢œè‰²æ¨¡å¼
   - å¤šè§†è§’è§‚å¯Ÿ

2. å¤šç‚¹äº‘å¯¹æ¯”å¯è§†åŒ–
   - å¹¶æ’æ˜¾ç¤ºæ¨¡å¼
   - å åŠ æ˜¾ç¤ºæ¨¡å¼
   - ç»Ÿè®¡å¯¹æ¯”åˆ†æ

3. æ•°æ®åˆ†æå›¾è¡¨
   - ç‚¹æ•°é‡å¯¹æ¯”æŸ±çŠ¶å›¾
   - æ–‡ä»¶å¤§å°å¯¹æ¯”å›¾
   - åæ ‡åˆ†å¸ƒç»Ÿè®¡
```

##### D. ç”¨æˆ·ç•Œé¢å­æ¨¡å—
```python
# é¡µé¢ç®¡ç†
class UIManager:
    def show_homepage():          # é¦–é¡µå±•ç¤º
    def show_navigation():        # å¯¼èˆªèœå•
    def show_sidebar_info():      # ä¾§è¾¹æ ä¿¡æ¯

# ç•Œé¢ç»“æ„
- å“åº”å¼å¸ƒå±€è®¾è®¡
- ä¾§è¾¹æ å¯¼èˆªç³»ç»Ÿ
- åŠ¨æ€å†…å®¹åŒºåŸŸ
- è¿›åº¦æŒ‡ç¤ºå™¨
- é”™è¯¯æç¤ºç³»ç»Ÿ
```

#### 2.2.3 æ•°æ®æµè®¾è®¡
```python
# æ•°æ®å¤„ç†æµç¨‹
ç”¨æˆ·ä¸Šä¼  â†’ æ–‡ä»¶éªŒè¯ â†’ å­˜å‚¨ç»„ç»‡ â†’ å…ƒæ•°æ®è®°å½• â†’ ç•Œé¢å±•ç¤º
    â†“
ç‚¹äº‘æ–‡ä»¶ â†’ æ ¼å¼æ£€æµ‹ â†’ æ•°æ®åŠ è½½ â†’ é‡‡æ ·å¤„ç† â†’ 3Då¯è§†åŒ–
    â†“
ç”¨æˆ·äº¤äº’ â†’ å‚æ•°è°ƒæ•´ â†’ å®æ—¶æ›´æ–° â†’ ç»“æœå±•ç¤º â†’ ç»Ÿè®¡åˆ†æ
```

### 2.3 æ•°æ®åº“ç®¡ç†æ¨¡å— (check_db.py)

#### 2.3.1 æ¨¡å—èŒè´£
æä¾›æ•°æ®åº“çŠ¶æ€æ£€æŸ¥ã€ç»´æŠ¤å’Œè°ƒè¯•åŠŸèƒ½ã€‚

#### 2.3.2 æ ¸å¿ƒåŠŸèƒ½
```python
def check_database_health():     # æ•°æ®åº“å¥åº·æ£€æŸ¥
def show_table_structure():      # è¡¨ç»“æ„æ˜¾ç¤º
def count_records():            # è®°å½•ç»Ÿè®¡
def check_data_integrity():     # æ•°æ®å®Œæ•´æ€§æ£€æŸ¥
```

### 2.4 æµ‹è¯•æ¨¡å—ç»„

#### 2.4.1 è®¤è¯åŠŸèƒ½æµ‹è¯• (test_auth.py)

```python
# æµ‹è¯•è¦†ç›–èŒƒå›´
class AuthTestSuite:
    def test_database_initialization():  # æ•°æ®åº“åˆå§‹åŒ–æµ‹è¯•
    def test_input_validation():        # è¾“å…¥éªŒè¯æµ‹è¯•
    def test_user_registration():       # ç”¨æˆ·æ³¨å†Œæµ‹è¯•
    def test_user_authentication():     # ç”¨æˆ·è®¤è¯æµ‹è¯•
    def test_session_management():      # ä¼šè¯ç®¡ç†æµ‹è¯•
    def test_security_features():       # å®‰å…¨ç‰¹æ€§æµ‹è¯•

# æµ‹è¯•ç”¨ä¾‹è®¾è®¡
- æ­£å‘æµ‹è¯•: æ­£å¸¸åŠŸèƒ½æµç¨‹éªŒè¯
- è´Ÿå‘æµ‹è¯•: å¼‚å¸¸è¾“å…¥å¤„ç†éªŒè¯
- è¾¹ç•Œæµ‹è¯•: æé™å€¼å¤„ç†éªŒè¯
- å®‰å…¨æµ‹è¯•: å®‰å…¨æœºåˆ¶æœ‰æ•ˆæ€§éªŒè¯
```

#### 2.4.2 ç‚¹äº‘åŠŸèƒ½æµ‹è¯• (test_pointcloud.py)

```python
# æµ‹è¯•åŠŸèƒ½è¦†ç›–
class PointCloudTestSuite:
    def test_pointcloud_loading():      # ç‚¹äº‘åŠ è½½æµ‹è¯•
    def test_format_support():          # æ ¼å¼æ”¯æŒæµ‹è¯•
    def test_data_validation():         # æ•°æ®éªŒè¯æµ‹è¯•
    def create_sample_data():           # æµ‹è¯•æ•°æ®ç”Ÿæˆ

# æµ‹è¯•æ•°æ®ç”Ÿæˆ
- è‡ªåŠ¨ç”Ÿæˆçƒå½¢ç‚¹äº‘æ ·æœ¬
- åˆ›å»ºå¤šç§æ ¼å¼æµ‹è¯•æ–‡ä»¶
- éªŒè¯æ•°æ®åŠ è½½æ­£ç¡®æ€§
- æµ‹è¯•å¯è§†åŒ–åŠŸèƒ½å®Œæ•´æ€§
```

#### 2.4.3 å•å…ƒæµ‹è¯• (test_pointcloud_unit.py)

```python
# åŸå­åŒ–æµ‹è¯•è®¾è®¡
class UnitTestSuite:
    def test_single_function():         # å•åŠŸèƒ½æµ‹è¯•
    def test_edge_cases():              # è¾¹ç•Œæƒ…å†µæµ‹è¯•
    def test_error_handling():          # é”™è¯¯å¤„ç†æµ‹è¯•

# æµ‹è¯•åŸåˆ™
- æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹åªæµ‹è¯•ä¸€ä¸ªåœºæ™¯
- æµ‹è¯•ç‹¬ç«‹æ€§ï¼Œæ— ä¾èµ–å…³ç³»
- å¿«é€Ÿæ‰§è¡Œï¼Œä¾¿äºæŒç»­é›†æˆ
```

### 2.5 å·¥å…·æ¨¡å—ç»„

#### 2.5.1 é¡¹ç›®çŠ¶æ€æ£€æŸ¥ (project_status.py)

```python
# ç³»ç»Ÿè‡ªæ£€åŠŸèƒ½
class StatusChecker:
    def check_file_integrity():        # æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥
    def check_dependencies():          # ä¾èµ–æ£€æŸ¥
    def check_database_status():       # æ•°æ®åº“çŠ¶æ€æ£€æŸ¥
    def check_functionality():         # åŠŸèƒ½éªŒè¯
    def generate_status_report():      # çŠ¶æ€æŠ¥å‘Šç”Ÿæˆ

# æ£€æŸ¥èŒƒå›´
- å¿…éœ€æ–‡ä»¶å­˜åœ¨æ€§éªŒè¯
- Pythonä¾èµ–åŒ…æ£€æŸ¥
- æ•°æ®åº“è¡¨ç»“æ„éªŒè¯
- æ ¸å¿ƒåŠŸèƒ½å¯ç”¨æ€§æµ‹è¯•
- æ¨èä½¿ç”¨æµç¨‹æŒ‡å¯¼
```

#### 2.5.2 ç™»å½•æ¼”ç¤º (demo_login.py)

```python
# æ¼”ç¤ºåŠŸèƒ½
class LoginDemo:
    def demonstrate_login_flow():      # ç™»å½•æµç¨‹æ¼”ç¤º
    def show_security_features():      # å®‰å…¨ç‰¹æ€§å±•ç¤º
    def test_user_scenarios():         # ç”¨æˆ·åœºæ™¯æµ‹è¯•

# æ¼”ç¤ºå†…å®¹
- å®Œæ•´ç™»å½•æ³¨å†Œæµç¨‹
- å®‰å…¨æœºåˆ¶æ¼”ç¤º
- é”™è¯¯å¤„ç†å±•ç¤º
- æœ€ä½³å®è·µæŒ‡å¯¼
```

### 2.6 é…ç½®ç®¡ç†æ¨¡å—

#### 2.6.1 ä¾èµ–é…ç½® (requirements.txt)

```python
# æ ¸å¿ƒä¾èµ–åˆ†ç±»
Webæ¡†æ¶:
    streamlit==1.29.0              # Webåº”ç”¨æ¡†æ¶

æ•°æ®å¤„ç†:
    pandas                         # æ•°æ®åˆ†æ
    numpy                          # æ•°å€¼è®¡ç®—

å¯è§†åŒ–:
    plotly                         # äº¤äº’å¼å›¾è¡¨
    open3d                         # 3Dç‚¹äº‘å¤„ç†
    matplotlib                     # åŸºç¡€ç»˜å›¾

å›¾åƒå¤„ç†:
    Pillow                         # å›¾åƒå¤„ç†
    opencv-python                  # è®¡ç®—æœºè§†è§‰

æ•°æ®æ ¼å¼:
    PyYAML                         # YAMLæ–‡ä»¶å¤„ç†
    laspy                          # LASç‚¹äº‘æ ¼å¼

ROSæ”¯æŒ:
    rosbag                         # ROSæ•°æ®åŒ…
    rospy                          # ROS Pythonåº“
```

#### 2.6.2 é¡¹ç›®é…ç½® (pyproject.toml)

```toml
# ä»£ç è´¨é‡é…ç½®
[tool.pyright]
include = ["**/*.py"]              # åŒ…å«æ‰€æœ‰Pythonæ–‡ä»¶
exclude = ["**/node_modules", "**/__pycache__"]  # æ’é™¤ç›®å½•
reportMissingImports = false       # å¿½ç•¥ç¼ºå¤±å¯¼å…¥
reportOptionalMemberAccess = false # å¿½ç•¥å¯é€‰æˆå‘˜è®¿é—®
pythonVersion = "3.9"              # Pythonç‰ˆæœ¬è¦æ±‚
```

## 3. æ¨¡å—é—´é€šä¿¡æœºåˆ¶

### 3.1 æ•°æ®ä¼ é€’æ–¹å¼

#### 3.1.1 å‡½æ•°è°ƒç”¨
```python
# ç›´æ¥å‡½æ•°è°ƒç”¨
auth_result = authenticate_user(username, password)
session_token = create_user_session(user_id)
point_cloud_data = load_point_cloud(file_path)
```

#### 3.1.2 Streamlit Session State
```python
# ä¼šè¯çŠ¶æ€ç®¡ç†
st.session_state.user = user_info
st.session_state.authenticated = True
st.session_state.selected_dataset_id = dataset_id
```

#### 3.1.3 æ•°æ®åº“äº¤äº’
```python
# ç»Ÿä¸€æ•°æ®åº“è®¿é—®
conn = sqlite3.connect('data.db')
# æ‰§è¡ŒæŸ¥è¯¢æ“ä½œ
conn.close()
```

### 3.2 é”™è¯¯å¤„ç†æœºåˆ¶

#### 3.2.1 å¼‚å¸¸ä¼ æ’­
```python
# åˆ†å±‚å¼‚å¸¸å¤„ç†
try:
    # ä¸šåŠ¡é€»è¾‘
    result = process_data()
except SpecificException as e:
    # ç‰¹å®šå¼‚å¸¸å¤„ç†
    handle_specific_error(e)
except Exception as e:
    # é€šç”¨å¼‚å¸¸å¤„ç†
    log_error(e)
    show_user_friendly_message()
```

#### 3.2.2 ç”¨æˆ·åé¦ˆ
```python
# Streamlitç”¨æˆ·åé¦ˆ
st.success("âœ… æ“ä½œæˆåŠŸ")
st.error("âŒ æ“ä½œå¤±è´¥: {error_message}")
st.warning("âš ï¸ è­¦å‘Šä¿¡æ¯")
st.info("ğŸ’¡ æç¤ºä¿¡æ¯")
```

## 4. æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 4.1 æ•°æ®å¤„ç†ä¼˜åŒ–

#### 4.1.1 ç‚¹äº‘é‡‡æ ·ç­–ç•¥
```python
# æ™ºèƒ½é‡‡æ ·ç®—æ³•
def intelligent_sampling(points, max_points=10000):
    if len(points) <= max_points:
        return points
    
    # éšæœºé‡‡æ ·
    indices = np.random.choice(len(points), max_points, replace=False)
    return points[indices]

# åˆ†çº§æ˜¾ç¤ºç­–ç•¥
- æ¦‚è§ˆæ¨¡å¼: 1000-5000ä¸ªç‚¹
- è¯¦ç»†æ¨¡å¼: 10000-50000ä¸ªç‚¹
- ä¸“ä¸šæ¨¡å¼: 50000-100000ä¸ªç‚¹
```

#### 4.1.2 å†…å­˜ç®¡ç†
```python
# å†…å­˜ä¼˜åŒ–æªæ–½
1. åŠæ—¶é‡Šæ”¾å¤§å‹æ•°ç»„
   del large_array
   
2. ä½¿ç”¨ç”Ÿæˆå™¨å‡å°‘å†…å­˜å ç”¨
   for chunk in data_generator():
       process_chunk(chunk)
       
3. ç¼“å­˜æœºåˆ¶å‡å°‘é‡å¤è®¡ç®—
   @st.cache_data
   def expensive_computation():
       return result
```

### 4.2 ç•Œé¢å“åº”ä¼˜åŒ–

#### 4.2.1 å¼‚æ­¥åŠ è½½
```python
# åˆ†æ­¥åŠ è½½ç­–ç•¥
with st.spinner("ğŸ”„ æ­£åœ¨åŠ è½½æ•°æ®..."):
    step1_result = load_metadata()
    
with st.spinner("ğŸ”„ æ­£åœ¨å¤„ç†ç‚¹äº‘..."):
    step2_result = process_pointcloud(step1_result)
    
with st.spinner("ğŸ”„ æ­£åœ¨ç”Ÿæˆå¯è§†åŒ–..."):
    visualization = create_visualization(step2_result)
```

#### 4.2.2 ç¼“å­˜ç­–ç•¥
```python
# Streamlitç¼“å­˜ä¼˜åŒ–
@st.cache_data(ttl=3600)  # 1å°æ—¶ç¼“å­˜
def load_dataset_list():
    return fetch_from_database()

@st.cache_resource
def initialize_visualization_engine():
    return VisualizationEngine()
```

## 5. å®‰å…¨å®ç°ç»†èŠ‚

### 5.1 è¾“å…¥éªŒè¯

#### 5.1.1 ç”¨æˆ·è¾“å…¥éªŒè¯
```python
# å¤šå±‚éªŒè¯æœºåˆ¶
def validate_user_input(data):
    # 1. æ ¼å¼éªŒè¯
    if not validate_format(data):
        raise ValidationError("æ ¼å¼ä¸æ­£ç¡®")
    
    # 2. é•¿åº¦éªŒè¯
    if not validate_length(data):
        raise ValidationError("é•¿åº¦è¶…å‡ºé™åˆ¶")
    
    # 3. å®‰å…¨éªŒè¯
    if not validate_security(data):
        raise ValidationError("åŒ…å«å±é™©å­—ç¬¦")
    
    return True
```

#### 5.1.2 æ–‡ä»¶ä¸Šä¼ å®‰å…¨
```python
# æ–‡ä»¶ç±»å‹ç™½åå•
ALLOWED_EXTENSIONS = {
    'pointcloud': ['.pcd', '.las', '.laz', '.txt', '.xyz'],
    'image': ['.png', '.jpg', '.jpeg'],
    'config': ['.yaml', '.yml'],
    'data': ['.csv', '.json'],
    'ros': ['.bag']
}

def validate_file_upload(file):
    # æ–‡ä»¶ç±»å‹æ£€æŸ¥
    # æ–‡ä»¶å¤§å°é™åˆ¶
    # æ–‡ä»¶å†…å®¹éªŒè¯
    return is_valid
```

### 5.2 æ•°æ®ä¿æŠ¤

#### 5.2.1 æ•æ„Ÿæ•°æ®åŠ å¯†
```python
# å¯†ç åŠ å¯†å­˜å‚¨
salt = secrets.token_hex(32)
password_hash = hashlib.pbkdf2_hmac(
    'sha256', 
    password.encode('utf-8'),
    salt.encode('utf-8'),
    100000  # è¿­ä»£æ¬¡æ•°
)
```

#### 5.2.2 ä¼šè¯å®‰å…¨
```python
# å®‰å…¨ä¼šè¯ç®¡ç†
def create_secure_session(user_id):
    token = secrets.token_urlsafe(32)  # åŠ å¯†å®‰å…¨ä»¤ç‰Œ
    expires_at = datetime.now() + timedelta(hours=24)
    
    # å­˜å‚¨ä¼šè¯ä¿¡æ¯
    store_session(user_id, token, expires_at)
    return token
```

## 6. æ‰©å±•æ¥å£è®¾è®¡

### 6.1 æ’ä»¶åŒ–æ¶æ„

#### 6.1.1 æ•°æ®æ ¼å¼æ‰©å±•æ¥å£
```python
# æŠ½è±¡åŸºç±»
class DataFormatHandler:
    def can_handle(self, file_path: str) -> bool:
        """åˆ¤æ–­æ˜¯å¦èƒ½å¤„ç†è¯¥æ ¼å¼"""
        pass
    
    def load_data(self, file_path: str) -> Tuple[np.ndarray, Optional[np.ndarray]]:
        """åŠ è½½æ•°æ®ï¼Œè¿”å›ç‚¹äº‘å’Œé¢œè‰²"""
        pass
    
    def get_metadata(self, file_path: str) -> Dict[str, Any]:
        """è·å–æ–‡ä»¶å…ƒæ•°æ®"""
        pass

# å…·ä½“å®ç°
class PCDHandler(DataFormatHandler):
    def can_handle(self, file_path: str) -> bool:
        return file_path.endswith('.pcd')
    
    def load_data(self, file_path: str):
        # PCDæ ¼å¼åŠ è½½å®ç°
        pass
```

#### 6.1.2 å¯è§†åŒ–æ‰©å±•æ¥å£
```python
# å¯è§†åŒ–æ’ä»¶æ¥å£
class VisualizationPlugin:
    def get_name(self) -> str:
        """æ’ä»¶åç§°"""
        pass
    
    def can_visualize(self, data_type: str) -> bool:
        """æ˜¯å¦æ”¯æŒè¯¥æ•°æ®ç±»å‹"""
        pass
    
    def create_visualization(self, data: Any) -> Any:
        """åˆ›å»ºå¯è§†åŒ–ç»„ä»¶"""
        pass
```

### 6.2 APIæ¥å£é¢„ç•™

#### 6.2.1 RESTful APIè®¾è®¡
```python
# æœªæ¥APIæ¥å£è§„åˆ’
class APIEndpoints:
    # ç”¨æˆ·ç®¡ç†
    POST /api/v1/auth/login
    POST /api/v1/auth/register
    POST /api/v1/auth/logout
    
    # æ•°æ®é›†ç®¡ç†
    GET /api/v1/datasets
    POST /api/v1/datasets
    GET /api/v1/datasets/{id}
    DELETE /api/v1/datasets/{id}
    
    # æ–‡ä»¶æ“ä½œ
    POST /api/v1/datasets/{id}/files
    GET /api/v1/datasets/{id}/files/{file_id}
    
    # å¯è§†åŒ–
    GET /api/v1/visualizations/{type}
    POST /api/v1/visualizations/generate
```

## 7. éƒ¨ç½²å’Œç»´æŠ¤

### 7.1 éƒ¨ç½²è‡ªåŠ¨åŒ–

#### 7.1.1 å¯åŠ¨è„šæœ¬è®¾è®¡
```bash
# Windowså¯åŠ¨è„šæœ¬ (start_app.bat)
1. ç¯å¢ƒæ£€æŸ¥
   - Pythonç‰ˆæœ¬éªŒè¯
   - ä¾èµ–åŒ…æ£€æŸ¥
   
2. ç¯å¢ƒå‡†å¤‡
   - ä¾èµ–åŒ…å®‰è£…
   - æ•°æ®åº“åˆå§‹åŒ–
   
3. æµ‹è¯•æ•°æ®ç”Ÿæˆ
   - åˆ›å»ºæ ·æœ¬ç‚¹äº‘æ–‡ä»¶
   - éªŒè¯åŠŸèƒ½å¯ç”¨æ€§
   
4. åº”ç”¨å¯åŠ¨
   - å¯åŠ¨StreamlitæœåŠ¡
   - è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨

# Unixå¯åŠ¨è„šæœ¬ (start_app.sh)
- ç›¸åŒåŠŸèƒ½çš„Linux/Macç‰ˆæœ¬
- æƒé™æ£€æŸ¥å’Œè®¾ç½®
- è¿›ç¨‹å®ˆæŠ¤é€‰é¡¹
```

#### 7.1.2 å¥åº·æ£€æŸ¥æœºåˆ¶
```python
# ç³»ç»Ÿå¥åº·æ£€æŸ¥
def health_check():
    checks = [
        check_database_connection(),
        check_file_permissions(),
        check_disk_space(),
        check_memory_usage(),
        check_dependency_availability()
    ]
    
    return all(checks)
```

### 7.2 ç›‘æ§å’Œæ—¥å¿—

#### 7.2.1 æ—¥å¿—ç³»ç»Ÿè®¾è®¡
```python
# åˆ†çº§æ—¥å¿—è®°å½•
import logging

# é…ç½®æ—¥å¿—
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('platform.log'),
        logging.StreamHandler()
    ]
)

# ä½¿ç”¨ç¤ºä¾‹
logger = logging.getLogger(__name__)
logger.info("ç”¨æˆ·ç™»å½•æˆåŠŸ: {username}")
logger.warning("ç‚¹äº‘æ–‡ä»¶åŠ è½½è­¦å‘Š: {filename}")
logger.error("æ•°æ®åº“è¿æ¥å¤±è´¥: {error}")
```

#### 7.2.2 æ€§èƒ½ç›‘æ§
```python
# æ€§èƒ½æŒ‡æ ‡æ”¶é›†
class PerformanceMonitor:
    def track_request_time(self, func):
        """è¯·æ±‚å¤„ç†æ—¶é—´ç›‘æ§"""
        pass
    
    def track_memory_usage(self):
        """å†…å­˜ä½¿ç”¨ç›‘æ§"""
        pass
    
    def track_user_activity(self, action):
        """ç”¨æˆ·è¡Œä¸ºç›‘æ§"""
        pass
```

## 8. æµ‹è¯•ç­–ç•¥è¯¦è§£

### 8.1 æµ‹è¯•å±‚æ¬¡

#### 8.1.1 å•å…ƒæµ‹è¯•
```python
# æµ‹è¯•è¦†ç›–èŒƒå›´
1. å‡½æ•°çº§æµ‹è¯•
   - è¾“å…¥è¾“å‡ºéªŒè¯
   - è¾¹ç•Œæ¡ä»¶æµ‹è¯•
   - å¼‚å¸¸å¤„ç†æµ‹è¯•

2. ç±»çº§æµ‹è¯•
   - æ–¹æ³•è°ƒç”¨æµ‹è¯•
   - çŠ¶æ€å˜æ›´æµ‹è¯•
   - ä¾èµ–æ³¨å…¥æµ‹è¯•

3. æ¨¡å—çº§æµ‹è¯•
   - æ¨¡å—æ¥å£æµ‹è¯•
   - æ¨¡å—é›†æˆæµ‹è¯•
   - æ¨¡å—éš”ç¦»æµ‹è¯•
```

#### 8.1.2 é›†æˆæµ‹è¯•
```python
# ç³»ç»Ÿé›†æˆéªŒè¯
1. æ•°æ®æµæµ‹è¯•
   - ç«¯åˆ°ç«¯æ•°æ®æµéªŒè¯
   - æ•°æ®è½¬æ¢æ­£ç¡®æ€§
   - æ•°æ®å®Œæ•´æ€§æ£€æŸ¥

2. ç•Œé¢é›†æˆæµ‹è¯•
   - ç”¨æˆ·æ“ä½œæµç¨‹éªŒè¯
   - ç•Œé¢å“åº”æµ‹è¯•
   - é”™è¯¯å¤„ç†æµ‹è¯•

3. å¤–éƒ¨ä¾èµ–æµ‹è¯•
   - æ•°æ®åº“æ“ä½œæµ‹è¯•
   - æ–‡ä»¶ç³»ç»Ÿæ“ä½œæµ‹è¯•
   - ç¬¬ä¸‰æ–¹åº“é›†æˆæµ‹è¯•
```

### 8.2 æµ‹è¯•è‡ªåŠ¨åŒ–

#### 8.2.1 æŒç»­é›†æˆ
```python
# CI/CDæµç¨‹è®¾è®¡
1. ä»£ç æäº¤è§¦å‘
   - è‡ªåŠ¨è¿è¡Œå•å…ƒæµ‹è¯•
   - ä»£ç è´¨é‡æ£€æŸ¥
   - å®‰å…¨æ‰«æ

2. æ„å»ºéªŒè¯
   - ä¾èµ–å®‰è£…æµ‹è¯•
   - åº”ç”¨å¯åŠ¨æµ‹è¯•
   - åŠŸèƒ½å¯ç”¨æ€§æµ‹è¯•

3. éƒ¨ç½²éªŒè¯
   - ç¯å¢ƒå…¼å®¹æ€§æµ‹è¯•
   - æ€§èƒ½åŸºå‡†æµ‹è¯•
   - å›æ»šæœºåˆ¶éªŒè¯
```

## 9. æ€»ç»“

æœ¬æ¨¡å—åˆ’åˆ†ä¸å®ç°æ–¹æ¡ˆä¸ºæ— äººé©¾é©¶æ•°æ®ç®¡ç†å¹³å°æä¾›äº†æ¸…æ™°çš„æ¶æ„æŒ‡å¯¼ï¼š

### 9.1 æ¨¡å—åŒ–ä¼˜åŠ¿
1. **èŒè´£æ¸…æ™°**: æ¯ä¸ªæ¨¡å—æœ‰æ˜ç¡®çš„åŠŸèƒ½è¾¹ç•Œ
2. **ä½è€¦åˆ**: æ¨¡å—é—´ä¾èµ–å…³ç³»ç®€å•æ˜ç¡®
3. **é«˜å†…èš**: ç›¸å…³åŠŸèƒ½é›†ä¸­åœ¨åŒä¸€æ¨¡å—å†…
4. **æ˜“æµ‹è¯•**: æ¯ä¸ªæ¨¡å—éƒ½æœ‰å¯¹åº”çš„æµ‹è¯•è¦†ç›–
5. **æ˜“ç»´æŠ¤**: æ¨¡å—åŒ–è®¾è®¡ä¾¿äºç‹¬ç«‹ç»´æŠ¤å’Œå‡çº§

### 9.2 å®ç°ç‰¹è‰²
1. **å®‰å…¨ä¼˜å…ˆ**: å®Œå–„çš„è®¤è¯æˆæƒæœºåˆ¶
2. **æ€§èƒ½ä¼˜åŒ–**: æ™ºèƒ½é‡‡æ ·å’Œç¼“å­˜ç­–ç•¥
3. **ç”¨æˆ·å‹å¥½**: ç›´è§‚çš„ç•Œé¢å’Œé”™è¯¯æç¤º
4. **æ‰©å±•æ€§å¼º**: æ’ä»¶åŒ–æ¶æ„æ”¯æŒåŠŸèƒ½æ‰©å±•
5. **éƒ¨ç½²ç®€å•**: è‡ªåŠ¨åŒ–è„šæœ¬ç®€åŒ–éƒ¨ç½²æµç¨‹

### 9.3 è´¨é‡ä¿è¯
1. **æµ‹è¯•é©±åŠ¨**: å®Œæ•´çš„æµ‹è¯•ä½“ç³»è¦†ç›–
2. **ä»£ç è§„èŒƒ**: ç»Ÿä¸€çš„ç¼–ç æ ‡å‡†
3. **æ–‡æ¡£å®Œå–„**: è¯¦ç»†çš„æŠ€æœ¯æ–‡æ¡£
4. **ç›‘æ§å®Œå¤‡**: å…¨é¢çš„ç³»ç»Ÿç›‘æ§æœºåˆ¶

è¯¥å®ç°æ–¹æ¡ˆä¸ºé¡¹ç›®çš„æŒç»­å‘å±•æä¾›äº†åšå®çš„æŠ€æœ¯åŸºç¡€ï¼Œèƒ½å¤Ÿæ»¡è¶³å½“å‰éœ€æ±‚å¹¶æ”¯æŒæœªæ¥çš„åŠŸèƒ½æ‰©å±•å’ŒæŠ€æœ¯æ¼”è¿›ã€‚