# 技术栈与依赖

<cite>
**本文档引用的文件**  
- [requirements.txt](file://config/requirements.txt)
- [main.py](file://src/main.py)
- [auth.py](file://src/auth.py)
- [check_db.py](file://src/check_db.py)
</cite>

## 目录
1. [技术栈概览](#技术栈概览)  
2. [Streamlit框架详解](#streamlit框架详解)  
3. [SQLite数据库机制](#sqlite数据库机制)  
4. [Open3D点云处理](#open3d点云处理)  
5. [Plotly 3D可视化](#plotly-3d可视化)  
6. [Pandas数据处理](#pandas数据处理)  
7. [环境配置指南](#环境配置指南)  
8. [技术选型分析](#技术选型分析)  
9. [学习资源与优化建议](#学习资源与优化建议)

## 技术栈概览

本项目采用轻量级技术栈构建无人驾驶数据管理平台，核心依赖包括Streamlit、SQLite、Open3D、Plotly和Pandas等库。系统通过`requirements.txt`文件精确管理版本依赖，确保开发与生产环境一致性。技术架构以Python为核心，结合Web前端框架与科学计算库，实现数据上传、浏览、可视化等功能。

**Section sources**  
- [requirements.txt](file://config/requirements.txt#L0-L11)

## Streamlit框架详解

Streamlit在本项目中作为Web界面构建的核心框架，负责实现用户交互界面和数据可视化展示。通过`st.title`、`st.sidebar`、`st.columns`等API构建多页面导航系统，支持首页、数据上传、数据浏览和可视化四大功能模块。利用`st.file_uploader`实现文件上传功能，`st.selectbox`和`st.slider`提供交互式参数控制，`st.plotly_chart`集成Plotly图表展示。

Streamlit的会话状态管理（`st.session_state`）用于用户认证状态维护，结合`st.form`实现登录注册表单。其`st.spinner`和`st.expander`组件提升用户体验，`st.balloons`提供操作反馈。整个Web应用无需前端开发知识，完全通过Python代码实现响应式界面。

**Section sources**  
- [main.py](file://src/main.py#L0-L806)
- [auth.py](file://src/auth.py#L8-L561)

## SQLite数据库机制

SQLite作为轻量级嵌入式数据库，承担本项目的数据持久化任务。系统通过`sqlite3.connect('data.db')`创建本地数据库文件，初始化两个核心表：`datasets`存储数据集元信息，`users`管理用户认证数据。`init_database`函数创建数据集表，包含ID、名称、描述、上传时间、文件数量和路径等字段。

数据操作采用标准SQL语句，通过`pd.read_sql_query`实现Pandas与SQLite的无缝集成。数据集上传时，文件路径以逗号分隔的字符串存入`file_paths`字段；数据浏览时，通过`SELECT * FROM datasets ORDER BY upload_time DESC`获取按时间排序的数据集列表。数据库连接在每次操作后及时关闭，确保数据安全。

**Section sources**  
- [main.py](file://src/main.py#L382-L398)
- [check_db.py](file://src/check_db.py#L0-L13)

## Open3D点云处理

Open3D库（版本0.18.0）在本项目中专门用于点云数据的加载与处理。通过`o3d.io.read_point_cloud`读取PCD格式点云文件，转换为NumPy数组进行后续处理。系统实现`load_point_cloud`函数，支持PCD、LAS/LAZ和TXT等多种点云格式的解析。

对于PCD文件，利用`np.asarray(pcd.points)`提取三维坐标，`np.asarray(pcd.colors)`获取颜色信息。系统包含异常处理机制，当Open3D未安装时显示警告信息并引导用户安装。点云数据的统计分析包括点数、坐标范围、均值和标准差计算，为后续可视化提供数据支持。

**Section sources**  
- [main.py](file://src/main.py#L29-L58)
- [main.py](file://src/main.py#L73-L110)

## Plotly 3D可视化

Plotly库（版本5.17.0）提供强大的3D可视化能力，通过`plotly.graph_objects`中的`Scatter3d`实现点云数据的三维渲染。系统创建交互式3D散点图，支持多种颜色映射模式：高度（Z轴）映射使用Viridis色谱，原始颜色模式保留点云自身色彩，均匀颜色模式统一着色。

可视化参数可动态调整，包括最大显示点数（默认10,000）、点大小（1-10可调）和视角模式（3D视角、XY/ XZ/ YZ平面视图）。通过`fig.update_layout`设置相机位置，实现不同观察角度。叠加显示模式使用调色板区分多个点云文件，对比分析功能生成点数和文件大小的柱状图，全面展示数据特征。

**Section sources**  
- [main.py](file://src/main.py#L144-L185)
- [main.py](file://src/main.py#L230-L260)

## Pandas数据处理

Pandas（版本2.1.4）在本项目中承担数据处理中枢角色，实现数据加载、转换和分析。通过`pd.read_csv`读取CSV文件，`pd.DataFrame`进行数据结构化处理。在数据可视化模块，Pandas与SQLite结合，使用`pd.read_sql_query`将数据库查询结果直接转换为DataFrame。

系统利用Pandas的数据分析功能，对CSV文件生成描述性统计信息，提取数值型列进行散点图和直方图可视化。在点云对比分析中，`pd.DataFrame(stats_data)`将多个点云的统计信息整合为对比表格，`st.dataframe`实现交互式展示。Pandas的`str.contains`方法支持数据集名称的模糊搜索功能。

**Section sources**  
- [main.py](file://src/main.py#L525-L557)
- [main.py](file://src/main.py#L637-L661)

## 环境配置指南

环境配置通过`requirements.txt`文件标准化管理，包含12个核心依赖项。安装步骤如下：

1. 创建Python虚拟环境：`python -m venv venv`
2. 激活虚拟环境：
   - Windows: `venv\Scripts\activate`
   - Linux/Mac: `source venv/bin/activate`
3. 安装依赖：`pip install -r config/requirements.txt`

关键依赖版本包括：streamlit==1.29.0、open3d==0.18.0、plotly==5.17.0、pandas==2.1.4。系统包含容错机制，当Open3D或laspy未安装时显示相应警告，确保核心功能仍可运行。启动脚本`start_app.bat`和`start_app.sh`提供跨平台启动支持。

**Section sources**  
- [requirements.txt](file://config/requirements.txt#L0-L11)
- [scripts/start_app.bat](file://scripts/start_app.bat)
- [scripts/start_app.sh](file://scripts/start_app.sh)

## 技术选型分析

技术选型基于轻量化、易用性和功能完整性原则。选择Streamlit而非Django或Flask，因其专为数据应用设计，能快速构建交互式界面，减少前端开发成本。SQLite作为嵌入式数据库，无需独立服务器进程，适合桌面级应用，相比MySQL或PostgreSQL更轻量，且`.db`文件便于数据迁移和备份。

Open3D被选为点云处理库，因其提供统一的PCD文件读写接口，支持丰富的点云处理算法。Plotly相比Matplotlib，提供更现代的交互式3D可视化体验。Pandas作为事实标准的数据处理库，与NumPy、SciPy等科学计算栈无缝集成。版本选择遵循"稳定优先"原则，采用经过充分测试的成熟版本，避免使用最新版可能引入的不稳定性。

**Section sources**  
- [main.py](file://src/main.py#L0-L806)
- [requirements.txt](file://config/requirements.txt#L0-L11)

## 学习资源与优化建议

### 新手学习资源
- **Streamlit**: 官方文档和30分钟入门教程
- **SQLite**: W3Schools SQL教程和Python sqlite3模块文档
- **Open3D**: 官方Python教程和点云处理示例
- **Plotly**: 交互式图表文档和3D可视化指南
- **Pandas**: 10分钟入门Pandas和数据处理最佳实践

### 专家性能优化建议
1. **点云采样优化**: 对超大点云采用空间采样而非随机采样，保持几何特征
2. **数据库索引**: 在`datasets`表的`upload_time`字段创建索引，加速时间排序查询
3. **内存管理**: 对大型CSV文件使用`pd.read_csv(chunksize)`分块读取
4. **缓存机制**: 利用Streamlit的`@st.cache_data`装饰器缓存耗时的数据处理操作
5. **并发处理**: 使用`concurrent.futures`并行加载多个点云文件
6. **Web优化**: 启用Gzip压缩和静态资源缓存，提升页面加载速度

**Section sources**  
- [main.py](file://src/main.py#L106-L148)
- [main.py](file://src/main.py#L287-L320)